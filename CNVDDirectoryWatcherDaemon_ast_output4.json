{"type": "program", "children": [{"type": "package_declaration", "children": [{"type": "scoped_identifier", "children": [{"type": "scoped_identifier", "children": [{"type": "scoped_identifier", "children": [{"type": "identifier", "text": "com"}, {"type": "identifier", "text": "asiainfo"}]}, {"type": "identifier", "text": "cvd"}]}, {"type": "identifier", "text": "daemon"}]}]}, {"type": "import_declaration", "children": [{"type": "scoped_identifier", "children": [{"_ref": "_ref_-5649524796421821439"}, {"type": "identifier", "text": "model"}]}]}, {"type": "import_declaration", "children": [{"type": "scoped_identifier", "children": [{"type": "scoped_identifier", "children": [{"type": "scoped_identifier", "children": [{"type": "scoped_identifier", "children": [{"type": "identifier", "text": "com"}, {"type": "identifier", "text": "fasterxml"}]}, {"type": "identifier", "text": "jackson"}]}, {"type": "identifier", "text": "databind"}]}, {"type": "identifier", "text": "ObjectMapper"}]}]}, {"type": "import_declaration", "children": [{"type": "scoped_identifier", "children": [{"_ref": "_ref_2002121277728601837"}, {"type": "identifier", "text": "SerializationFeature"}]}]}, {"type": "import_declaration", "children": [{"type": "scoped_identifier", "children": [{"type": "scoped_identifier", "children": [{"type": "scoped_identifier", "children": [{"type": "identifier", "text": "org"}, {"type": "identifier", "text": "w3c"}]}, {"type": "identifier", "text": "dom"}]}, {"type": "identifier", "text": "Document"}]}]}, {"type": "import_declaration", "children": [{"type": "scoped_identifier", "children": [{"_ref": "_ref_-7270545121095630539"}, {"type": "identifier", "text": "Element"}]}]}, {"type": "import_declaration", "children": [{"type": "scoped_identifier", "children": [{"_ref": "_ref_-7270545121095630539"}, {"type": "identifier", "text": "NodeList"}]}]}, {"type": "import_declaration", "children": [{"type": "scoped_identifier", "children": [{"type": "scoped_identifier", "children": [{"type": "scoped_identifier", "children": [{"type": "identifier", "text": "javax"}, {"type": "identifier", "text": "xml"}]}, {"type": "identifier", "text": "parsers"}]}, {"type": "identifier", "text": "DocumentBuilder"}]}]}, {"type": "import_declaration", "children": [{"type": "scoped_identifier", "children": [{"_ref": "_ref_-3719504930723274547"}, {"type": "identifier", "text": "DocumentBuilderFactory"}]}]}, {"type": "import_declaration", "children": [{"type": "scoped_identifier", "children": [{"type": "identifier", "text": "java"}, {"type": "identifier", "text": "io"}]}, {"type": "asterisk", "children": [{"_ref": "_ref_-71275807441104587"}]}]}, {"type": "import_declaration", "children": [{"type": "scoped_identifier", "children": [{"type": "scoped_identifier", "children": [{"type": "identifier", "text": "java"}, {"type": "identifier", "text": "nio"}]}, {"type": "identifier", "text": "file"}]}, {"type": "asterisk", "children": [{"_ref": "_ref_-71275807441104587"}]}]}, {"type": "import_declaration", "children": [{"type": "scoped_identifier", "children": [{"type": "identifier", "text": "java"}, {"type": "identifier", "text": "util"}]}, {"type": "asterisk", "children": [{"_ref": "_ref_-71275807441104587"}]}]}, {"type": "import_declaration", "children": [{"type": "scoped_identifier", "children": [{"type": "scoped_identifier", "children": [{"type": "scoped_identifier", "children": [{"_ref": "_ref_1679906701481647812"}, {"type": "identifier", "text": "utils"}]}, {"type": "identifier", "text": "XMLFilesUtils"}]}, {"type": "identifier", "text": "collectXMLFiles"}]}]}, {"type": "import_declaration", "children": [{"type": "scoped_identifier", "children": [{"_ref": "_ref_2379422868864586990"}, {"type": "identifier", "text": "getStringFromXmlElement"}]}]}, {"type": "import_declaration", "children": [{"type": "scoped_identifier", "children": [{"type": "scoped_identifier", "children": [{"type": "identifier", "text": "org"}, {"type": "identifier", "text": "slf4j"}]}, {"type": "identifier", "text": "Logger"}]}]}, {"type": "import_declaration", "children": [{"type": "scoped_identifier", "children": [{"_ref": "_ref_4762193969980754749"}, {"type": "identifier", "text": "LoggerFactory"}]}]}, {"type": "import_declaration", "children": [{"type": "scoped_identifier", "children": [{"type": "scoped_identifier", "children": [{"_ref": "_ref_-5649524796421821439"}, {"type": "identifier", "text": "service"}]}, {"type": "identifier", "text": "ComponentService"}]}]}, {"type": "import_declaration", "children": [{"type": "scoped_identifier", "children": [{"_ref": "_ref_-3471180852354061361"}, {"type": "identifier", "text": "VulnerabilityService"}]}]}, {"type": "class_declaration", "name": "CNVDDirectoryWatcherDaemon", "modifiers": ["public"], "members": {"fields": [{"type": "field_declaration", "children": [{"type": "modifiers", "text": "private static final"}, {"type": "type_identifier", "text": "Logger"}, {"type": "variable_declarator", "children": [{"type": "identifier", "text": "logger"}, {"type": "method_invocation", "children": [{"type": "identifier", "text": "LoggerFactory"}, {"type": "identifier", "text": "getLogger"}, {"type": "argument_list", "text": "(CNVDDirectoryWatcherDaemon.class)"}]}]}]}, {"type": "field_declaration", "children": [{"_ref": "_ref_5000509798034353843"}, {"type": "type_identifier", "text": "String"}, {"type": "variable_declarator", "children": [{"type": "identifier", "text": "BASE_DIR"}, {"_ref": "_ref_3444461420990802935"}, {"type": "method_invocation", "children": [{"type": "identifier", "text": "System"}, {"type": "identifier", "text": "getProperty"}, {"type": "argument_list", "text": "(\"user.dir\")"}]}]}]}, {"type": "field_declaration", "children": [{"_ref": "_ref_5000509798034353843"}, {"_ref": "_ref_5330250463985925147"}, {"type": "variable_declarator", "children": [{"type": "identifier", "text": "DIRECTORY_PATH"}, {"_ref": "_ref_3444461420990802935"}, {"type": "method_invocation", "children": [{"type": "method_invocation", "children": [{"type": "identifier", "text": "Paths"}, {"type": "identifier", "text": "get"}, {"type": "argument_list", "text": "(BASE_DIR, \"cnvd\")"}]}, {"type": "identifier", "text": "toString"}, {"type": "argument_list", "text": "()"}]}]}]}, {"type": "field_declaration", "children": [{"_ref": "_ref_5000509798034353843"}, {"_ref": "_ref_5330250463985925147"}, {"type": "variable_declarator", "children": [{"type": "identifier", "text": "DATA_STORE_PATH"}, {"_ref": "_ref_3444461420990802935"}, {"type": "method_invocation", "children": [{"type": "method_invocation", "children": [{"type": "identifier", "text": "Paths"}, {"type": "identifier", "text": "get"}, {"type": "argument_list", "text": "(BASE_DIR, \"data_store\")"}]}, {"type": "identifier", "text": "toString"}, {"_ref": "_ref_386305488891542824"}]}]}]}, {"type": "field_declaration", "children": [{"_ref": "_ref_5000509798034353843"}, {"_ref": "_ref_5330250463985925147"}, {"type": "variable_declarator", "children": [{"type": "identifier", "text": "PROCESS_STATUS_FILE"}, {"_ref": "_ref_3444461420990802935"}, {"type": "method_invocation", "children": [{"type": "method_invocation", "children": [{"type": "identifier", "text": "Paths"}, {"type": "identifier", "text": "get"}, {"type": "argument_list", "text": "(BASE_DIR, \"process_status.json\")"}]}, {"type": "identifier", "text": "toString"}, {"_ref": "_ref_386305488891542824"}]}]}]}, {"type": "field_declaration", "children": [{"_ref": "_ref_5000509798034353843"}, {"type": "type_identifier", "text": "ObjectMapper"}, {"type": "variable_declarator", "children": [{"type": "identifier", "text": "objectMapper"}, {"_ref": "_ref_3444461420990802935"}, {"type": "method_invocation", "children": [{"type": "object_creation_expression", "children": [{"_ref": "_ref_7462867578125981548"}, {"_ref": "_ref_386305488891542824"}]}, {"type": "identifier", "text": "enable"}, {"type": "argument_list", "text": "(SerializationFeature.INDENT_OUTPUT)"}]}]}]}, {"type": "field_declaration", "children": [{"_ref": "_ref_5000509798034353843"}, {"type": "variable_declarator", "children": [{"type": "identifier", "text": "SCAN_INTERVAL"}, {"_ref": "_ref_3444461420990802935"}, {"type": "decimal_integer_literal", "text": "8000"}]}]}, {"type": "field_declaration", "children": [{"_ref": "_ref_5000509798034353843"}, {"type": "type_identifier", "text": "ComponentService"}, {"type": "variable_declarator", "children": [{"type": "identifier", "text": "componentService"}, {"_ref": "_ref_3444461420990802935"}, {"type": "object_creation_expression", "children": [{"_ref": "_ref_-7861121334358671104"}, {"_ref": "_ref_6647277157457618020"}, {"_ref": "_ref_386305488891542824"}]}]}]}, {"type": "field_declaration", "children": [{"_ref": "_ref_5000509798034353843"}, {"type": "type_identifier", "text": "VulnerabilityService"}, {"type": "variable_declarator", "children": [{"type": "identifier", "text": "vulnerabilityService"}, {"_ref": "_ref_3444461420990802935"}, {"type": "object_creation_expression", "children": [{"_ref": "_ref_-7861121334358671104"}, {"_ref": "_ref_769063909236214076"}, {"type": "argument_list", "text": "(DATA_STORE_PATH)"}]}]}]}], "methods": [{"type": "method_declaration", "name": "main", "modifiers": ["public", "static"], "parameters": [{"name": "args"}], "body_summary": {"line_comment": 1, "expression_statement": 9, "local_variable_declaration": 2, "try_statement": 1}}, {"type": "method_declaration", "name": "isFileProcessed", "modifiers": ["private", "static"], "parameters": [{"type": "String", "name": "fileName"}], "body_summary": {"try_statement": 1}}, {"type": "method_declaration", "name": "markFileStatus", "modifiers": ["private", "static"], "parameters": [{"type": "String", "name": "fileName"}, {"type": "String", "name": "status"}], "body_summary": {"local_variable_declaration": 2, "if_statement": 1, "expression_statement": 2}}, {"type": "method_declaration", "name": "scanDirectory", "modifiers": ["private", "static"], "body_summary": {"local_variable_declaration": 2, "if_statement": 1}}, {"type": "method_declaration", "name": "processXmlFile", "modifiers": ["private", "static"], "parameters": [{"type": "File", "name": "xmlFile"}], "body_summary": {"local_variable_declaration": 1, "if_statement": 1, "try_statement": 1}}, {"type": "method_declaration", "name": "backupXMLFileForException", "modifiers": ["private", "static"], "parameters": [{"type": "File", "name": "xmlFile"}], "body_summary": {"local_variable_declaration": 5, "expression_statement": 1, "if_statement": 1}}, {"type": "method_declaration", "name": "backupXMLFile", "modifiers": ["private", "static"], "parameters": [{"type": "File", "name": "xmlFile"}], "body_summary": {"expression_statement": 3, "local_variable_declaration": 7, "try_statement": 1}}, {"type": "method_declaration", "name": "createDirectory", "modifiers": ["private", "static"], "parameters": [{"type": "String", "name": "directory"}], "body_summary": {"local_variable_declaration": 1, "if_statement": 1}}]}}]}