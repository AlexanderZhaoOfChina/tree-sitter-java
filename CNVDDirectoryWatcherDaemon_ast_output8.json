{"key_mapping": {"type": "t", "name": "n", "file_info": "fi", "structure": "s", "classes": "cs", "methods": "ms", "fields": "fs", "parameters": "ps", "modifiers": "mod", "return_type": "rt", "control_flow": "cf", "data_flow": "df", "flow_elements": "fe", "condition": "cond", "variables": "vars", "usage_summary": "us", "declarations": "decl", "reads": "rd", "writes": "wr", "method_analysis": "ma", "complexity": "cx", "max_nesting": "mn", "intent": "in", "complexity_rating": "cr", "key_comments": "kc", "text": "txt", "package": "pkg", "imports": "imp", "total_lines": "tl", "has_value": "hv", "exception_type": "et", "call_count": "cc"}, "data": {"fi": {"t": "Java source file", "pkg": "com.asiainfo.cvd.daemon", "imp": ["com.asiainfo.cvd.model", "com.fasterxml.jackson.databind.ObjectMapper", "com.fasterxml.jackson.databind.SerializationFeature", "org.w3c.dom.Document", "org.w3c.dom.Element", "org.w3c.dom.NodeList", "javax.xml.parsers.DocumentBuilder", "javax.xml.parsers.DocumentBuilderFactory", "java.io", "java.nio.file", "java.util", "com.asiainfo.utils.XMLFilesUtils.collectXMLFiles", "com.asiainfo.utils.XMLFilesUtils.getStringFromXmlElement", "org.slf4j.Logger", "org.slf4j.LoggerFactory", "com.asiainfo.cvd.service.ComponentService", "com.asiainfo.cvd.service.VulnerabilityService"], "tl": 366}, "s": {"cs": [{"t": "class", "n": "CNVDDirectoryWatcherDaemon", "mod": ["public"], "fs": [{"n": "logger", "t": "Logger", "mod": ["private", "static", "final"]}, {"n": "BASE_DIR", "t": "String", "mod": ["private", "static", "final"]}, {"n": "DIRECTORY_PATH", "t": "String", "mod": ["private", "static", "final"]}, {"n": "DATA_STORE_PATH", "t": "String", "mod": ["private", "static", "final"]}, {"n": "PROCESS_STATUS_FILE", "t": "String", "mod": ["private", "static", "final"]}, {"n": "objectMapper", "t": "ObjectMapper", "mod": ["private", "static", "final"]}, {"n": "componentService", "t": "ComponentService", "mod": ["private", "static", "final"]}, {"n": "vulnerabilityService", "t": "VulnerabilityService", "mod": ["private", "static", "final"]}], "ms": [{"t": "method", "n": "main", "mod": ["public", "static"], "rt": "void", "ps": [{"n": "args"}]}, {"t": "method", "n": "isFileProcessed", "mod": ["private", "static"], "ps": [{"t": "String", "n": "fileName"}]}, {"t": "method", "n": "markFileStatus", "mod": ["private", "static"], "rt": "void", "ps": [{"t": "String", "n": "fileName"}, {"t": "String", "n": "status"}]}, {"t": "method", "n": "scanDirectory", "mod": ["private", "static"], "rt": "void"}, {"t": "method", "n": "processXmlFile", "mod": ["private", "static"], "rt": "void", "ps": [{"t": "File", "n": "xmlFile"}]}, {"t": "method", "n": "backupXMLFileForException", "mod": ["private", "static"], "rt": "void", "ps": [{"t": "File", "n": "xmlFile"}]}, {"t": "method", "n": "backupXMLFile", "mod": ["private", "static"], "rt": "void", "ps": [{"t": "File", "n": "xmlFile"}]}, {"t": "method", "n": "createDirectory", "mod": ["private", "static"], "rt": "void", "ps": [{"t": "String", "n": "directory"}]}]}]}, "cf": {"main": {"fe": []}, "run": {"fe": [{"t": "try_statement", "catches": [{"t": "catch"}]}, {"t": "try_statement", "catches": [{"t": "catch"}]}]}, "isFileProcessed": {"fe": [{"t": "try_statement", "catches": [{"t": "catch"}]}, {"t": "if_statement", "cond": "!statusFile.exists()"}, {"t": "return_statement", "hv": true}, {"t": "return_statement", "hv": true}, {"t": "return_statement", "hv": true}]}, "markFileStatus": {"fe": [{"t": "if_statement", "cond": "statusFile.exists()"}]}, "scanDirectory": {"fe": [{"t": "if_statement", "cond": "directory.exists() && direc..."}]}, "processXmlFile": {"fe": [{"t": "if_statement", "cond": "isFileProcessed(sourceFileN..."}, {"t": "return_statement", "hv": true}, {"t": "try_statement", "catches": [{"t": "catch"}]}, {"t": "for_statement"}, {"t": "for_statement"}, {"t": "for_statement"}, {"t": "if_statement", "cond": "vulnerabilities.isEmpty()"}, {"t": "return_statement", "hv": true}, {"t": "if_statement", "cond": "!alertList.isEmpty()"}]}, "backupXMLFileForException": {"fe": [{"t": "if_statement", "cond": "Files.exists(Path.of(source..."}]}, "backupXMLFile": {"fe": [{"t": "try_statement", "catches": [{"t": "catch"}]}, {"t": "if_statement", "cond": "Files.exists(Path.of(source..."}, {"t": "return_statement", "hv": true}]}, "createDirectory": {"fe": [{"t": "if_statement", "cond": "!file.exists()"}]}}, "df": {"vars": {"createDirectory": {"t": "unknown", "usage_by_method": {"main": "3次读", "backupXMLFileForException": "1次读", "backupXMLFile": "1次读", "createDirectory": "1次读"}}, "DIRECTORY_PATH": {"t": "unknown", "usage_by_method": {"main": "2次读", "scanDirectory": "1次读"}}, "DATA_STORE_PATH": {"t": "unknown", "usage_by_method": {"main": "2次读"}}, "BASE_DIR": {"t": "unknown", "usage_by_method": {"main": "3次读"}}, "logger": {"t": "unknown", "usage_by_method": {"main": "4次读", "run": "5次读", "scanDirectory": "2次读", "processXmlFile": "6次读", "backupXMLFileForException": "1次读", "backupXMLFile": "4次读"}}, "info": {"t": "unknown", "usage_by_method": {"main": "4次读", "run": "3次读", "scanDirectory": "2次读", "processXmlFile": "4次读", "backupXMLFileForException": "1次读", "backupXMLFile": "3次读"}}, "startTime": {"t": "unknown", "usage_by_method": {"run": "1次声明、2次读", "scanDirectory": "1次声明、2次读", "processXmlFile": "1次声明、2次读"}}, "System": {"t": "unknown", "usage_by_method": {"run": "2次读", "scanDirectory": "2次读", "processXmlFile": "2次读", "backupXMLFile": "2次读"}}, "currentTimeMillis": {"t": "unknown", "usage_by_method": {"run": "2次读", "scanDirectory": "2次读", "processXmlFile": "2次读", "backupXMLFile": "2次读"}}, "e": {"t": "unknown", "usage_by_method": {"run": "5次读", "isFileProcessed": "1次读", "processXmlFile": "2次读", "backupXMLFile": "2次读"}}, "fileName": {"t": "unknown", "usage_by_method": {"isFileProcessed": "3次读", "markFileStatus": "2次读"}}, "statusFile": {"t": "unknown", "usage_by_method": {"isFileProcessed": "1次声明、3次读", "markFileStatus": "1次声明、4次读"}}, "PROCESS_STATUS_FILE": {"t": "unknown", "usage_by_method": {"isFileProcessed": "1次读", "markFileStatus": "1次读"}}, "exists": {"t": "unknown", "usage_by_method": {"isFileProcessed": "1次读", "markFileStatus": "1次读", "scanDirectory": "1次读", "backupXMLFileForException": "1次读", "backupXMLFile": "1次读", "createDirectory": "1次读"}}, "processStatus": {"t": "unknown", "usage_by_method": {"isFileProcessed": "1次声明、3次读", "markFileStatus": "1次声明、5次读、2次写"}}, "objectMapper": {"t": "unknown", "usage_by_method": {"isFileProcessed": "2次读", "markFileStatus": "3次读"}}, "directory": {"t": "unknown", "usage_by_method": {"scanDirectory": "1次声明、4次读", "createDirectory": "2次读"}}, "xmlFile": {"t": "unknown", "usage_by_method": {"scanDirectory": "4次读", "processXmlFile": "12次读", "backupXMLFileForException": "4次读", "backupXMLFile": "5次读"}}, "getName": {"t": "unknown", "usage_by_method": {"scanDirectory": "2次读", "processXmlFile": "6次读", "backupXMLFileForException": "1次读", "backupXMLFile": "2次读"}}, "sourceFileNameWithoutSuffix": {"t": "unknown", "usage_by_method": {"processXmlFile": "1次声明、12次读"}}, "vulnerabilities": {"t": "unknown", "usage_by_method": {"processXmlFile": "1次声明、4次读"}}, "cves": {"t": "unknown", "usage_by_method": {"processXmlFile": "1次声明、4次读"}}, "i": {"t": "unknown", "usage_by_method": {"processXmlFile": "1次声明、4次读"}}, "vulnerability": {"t": "unknown", "usage_by_method": {"processXmlFile": "1次声明、14次读"}}, "number": {"t": "unknown", "usage_by_method": {"processXmlFile": "1次声明、4次读"}}, "getStringFromXmlElement": {"t": "unknown", "usage_by_method": {"processXmlFile": "13次读"}}, "boVulnerability": {"t": "unknown", "usage_by_method": {"processXmlFile": "2次声明、22次读"}}, "j": {"t": "unknown", "usage_by_method": {"processXmlFile": "1次声明、4次读"}}, "boVulnerabilityCve": {"t": "unknown", "usage_by_method": {"processXmlFile": "1次声明、6次读"}}, "k": {"t": "unknown", "usage_by_method": {"processXmlFile": "1次声明、4次读"}}, "boVulnerabilityProduct": {"t": "unknown", "usage_by_method": {"processXmlFile": "1次声明、8次读"}}, "vulnerabilityService": {"t": "unknown", "usage_by_method": {"processXmlFile": "5次读"}}, "alertBrief": {"t": "unknown", "usage_by_method": {"processXmlFile": "1次声明、4次读"}}, "alertList": {"t": "unknown", "usage_by_method": {"processXmlFile": "1次声明、6次读、1次写"}}, "componentService": {"t": "unknown", "usage_by_method": {"processXmlFile": "2次读"}}, "vulnerabilityAlert": {"t": "unknown", "usage_by_method": {"processXmlFile": "1次声明、12次读"}}, "sourceDirectory": {"t": "unknown", "usage_by_method": {"backupXMLFileForException": "1次声明、2次读", "backupXMLFile": "1次声明、2次读"}}, "sourceFileName": {"t": "unknown", "usage_by_method": {"backupXMLFileForException": "1次声明、3次读", "backupXMLFile": "1次声明、4次读"}}, "sourcePath": {"t": "unknown", "usage_by_method": {"backupXMLFileForException": "1次声明、3次读", "backupXMLFile": "1次声明、3次读"}}, "backupDirectory": {"t": "unknown", "usage_by_method": {"backupXMLFileForException": "1次声明、3次读", "backupXMLFile": "1次声明、3次读"}}, "backupPath": {"t": "unknown", "usage_by_method": {"backupXMLFileForException": "1次声明、2次读", "backupXMLFile": "1次声明、2次读"}}, "Path": {"t": "unknown", "usage_by_method": {"backupXMLFileForException": "3次读", "backupXMLFile": "3次读"}}, "of": {"t": "unknown", "usage_by_method": {"backupXMLFileForException": "3次读", "backupXMLFile": "3次读"}}}}, "ma": {"main": {"cx": 1, "mn": 1, "in": "entry_point", "cr": "低"}, "run": {"cx": 1, "mn": 1, "in": "processor", "cr": "低"}, "isFileProcessed": {"cx": 2, "mn": 3, "in": "accessor", "called_by": 1, "cr": "低"}, "markFileStatus": {"cx": 2, "mn": 1, "called_by": 1, "cr": "低"}, "scanDirectory": {"cx": 2, "mn": 1, "called_by": 1, "cr": "低"}, "processXmlFile": {"cx": 7, "mn": 3, "in": "processor", "called_by": 1, "cr": "中"}, "backupXMLFileForException": {"cx": 2, "mn": 1, "called_by": 1, "cr": "低"}, "backupXMLFile": {"cx": 2, "mn": 2, "called_by": 1, "cr": "低"}, "createDirectory": {"cx": 2, "mn": 1, "in": "factory", "called_by": 1, "cr": "低"}}, "kc": [{"t": "doc_comment", "txt": "/**\n* CNVD漏洞信息监控守护进程\n* 功能：\n* 1. 监控指定目录下的XML文件\n* 2. 解析XML文件中的漏洞信息\n* 3. 将漏洞信息存储为JSON文件\n* 4. 生成漏洞预警信息并发送邮件通知\n* 5. 备份已处理的XML文件\n*/"}, {"t": "line_comment", "txt": "// 处理状态记录文件"}, {"t": "doc_comment", "txt": "/**\n* 程序入口：启动CNVD目录监控守护进程\n*/"}, {"t": "doc_comment", "txt": "/**\n* 检查文件是否已处理\n*/"}, {"t": "doc_comment", "txt": "/**\n* 标记文件处理状态\n*/"}, {"t": "doc_comment", "txt": "/**\n* 高级目录扫描方法\n*/"}, {"t": "doc_comment", "txt": "/**\n* 处理单个XML文件\n*/"}, {"t": "doc_comment", "txt": "/**\n* 将处理异常的XML文件备份到指定目录\n*\n* @param xmlFile 需要备份的XML文件\n* @throws IOException IO异常\n*/"}, {"t": "doc_comment", "txt": "/**\n* 将处理完成的XML文件备份到指定目录\n*\n* @param xmlFile 需要备份的XML文件\n* @throws IOException IO异常\n*/"}, {"t": "doc_comment", "txt": "/**\n* 创建目录（如果不存在）\n*\n* @param directory 目录路径\n*/"}]}}